<div class="article">
  <ng-container *ngTemplateOutlet="template_header"></ng-container>
  <!-- objectives -->
  <ng-container *ngIf="objective.texts.length > 0">
    <ng-container *ngTemplateOutlet="template_objectives"></ng-container>
  </ng-container>
  <!-- augments -->
  <ng-container *ngIf="augments.length > 0">
    <ng-container *ngTemplateOutlet="template_augments"></ng-container>
  </ng-container>
  <!-- itembuilds -->
  <ng-container *ngIf="itemBuilds.length > 0">
    <ng-container *ngTemplateOutlet="template_itembuilds"></ng-container>
  </ng-container>
</div>

<ng-template #template_header>
  <div class="header">
    <img class="header__image" [src]="champ.icon" [alt]="champ.name" />
    <span class="header__text">{{ champ.name }}</span>
  </div>
</ng-template>

<ng-template #template_item_with_image let-item>
  <a
    *ngIf="item"
    class="item_with_image image_round_with_border"
    [class.weapon]="isWeapon(item)"
  >
    <img [src]="item.item.icon" [alt]="item.item.name" /><span>{{
      item.item.name
    }}</span>
  </a>
</ng-template>

<ng-template #template_objectives>
  <div class="subheader">
    <i class="subheader__image ri-award-fill"></i>
    <span class="subheader__text">Objectives</span>
  </div>

  <div class="container-wrapper-vertical">
    <div class="box objective">
      <p>
        @for (text of objective.texts; track text; let i = $index) {
        <ng-template #defaultText let-text> {{ text }}</ng-template>

        <ng-container *ngIf="!matchRegex(text, '\\$\\d+')">
          <ng-container
            *ngTemplateOutlet="
              defaultText;
              context: {
                $implicit: text
              }
            "
          ></ng-container>
        </ng-container>
        <ng-container *ngIf="matchRegex(text, '\\$\\d+')">
          <ng-container
            *ngTemplateOutlet="
              template_item_with_image;
              context: {
                $implicit: objective.items[+text.substring(1)]
              }
            "
          ></ng-container>
        </ng-container>
        }
      </p>
    </div>
  </div>
</ng-template>

<ng-template #template_augments>
  <div class="subheader">
    <i class="subheader__image ri-flashlight-fill"></i>
    <span class="subheader__text">Recommended Yuumi augments</span>
  </div>

  <div class="container-wrapper-vertical">
    <div class="box augment" *ngFor="let augment of augments">
      <img class="augment__icon" [src]="augment.icon" [alt]="augment.name" />
      <div class="augment__container">
        <div class="augment__container__name">
          {{ augment.name }}
        </div>
        <div class="augment__container__desc" [innerHTML]="augment.desc"></div>
      </div>
    </div>
  </div>
</ng-template>

<ng-template #template_itembuilds>
  <div class="subheader">
    <i class="subheader__image ri-book-shelf-fill"></i>
    <span class="subheader__text">Builds</span>
  </div>

  <div class="container-wrapper-vertical">
    <div class="itembuild" *ngFor="let itemBuild of itemBuilds">
      <div class="itembuild__top">
        <!-- name and desc on left side -->
        <div class="itembuild__top__left">
          <div class="itembuild__top__left__name">
            {{ itemBuild.name }}
          </div>
          <div class="itembuild__top__left__desc">
            {{ itemBuild.desc }}
          </div>
        </div>

        <!-- abilities and weapons on right side -->
        <div class="itembuild__top__right">
          <div class="itembuild__top__right__area">
            <div class="itembuild__top__right__area__title">Abilities</div>
            <div class="itembuild__top__right__area__content">
              <!-- abilities -->
              <div
                class="itembuild__top__right__area__content__item"
                *ngFor="let ability of itemBuild.abilities"
              >
                <img
                  class="itembuild__top__right__area__content__item__image"
                  [src]="ability.icon"
                  [alt]="ability.name"
                />
                <p
                  class="itembuild__top__right__area__content__item__item-text"
                >
                  {{ ability.type }}
                </p>
              </div>
            </div>
          </div>

          <div class="itembuild__top__right__area">
            <div class="itembuild__top__right__area__title">Weapons</div>
            <div class="itembuild__top__right__area__content">
              <!-- weapons -->
              <div
                class="itembuild__top__right__area__content__item"
                *ngFor="let weapon of itemBuild.weapons"
              >
                <img
                  class="itembuild__top__right__area__content__item__image"
                  [src]="weapon.iconEvolve"
                  [alt]="weapon.name"
                />
                <p
                  class="itembuild__top__right__area__content__item__item-text"
                >
                  {{ weapon.name }}
                </p>
              </div>
            </div>
          </div>
        </div>
      </div>
      <!-- passives on the bottom -->
      <div class="itembuild__bottom">
        <div class="itembuild__bottom__title">Passives</div>
        <div class="itembuild__bottom__content">
          <div class="itembuild__bottom__content__passives">
            <div
              class="itembuild__bottom__content__passives__passive"
              *ngFor="let passive of itemBuild.passives"
            >
              <img [src]="passive.icon" [alt]="passive.name" />
              <div class="itembuild__bottom__content__passives__passive__name">
                {{ passive.name }}
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</ng-template>
